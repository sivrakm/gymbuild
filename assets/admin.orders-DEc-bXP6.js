import{a as O,u as E,r as c,j as e,C as W,z as P,A as j,E as R,H as q,I as B,D as $,O as H,P as M}from"./index-C55yDX4G.js";import{a as o,T as a,b as d}from"./Button-B2Q29cgF.js";import{I as g}from"./IconButton-CPN700ET.js";import{A as U}from"./ArrowBack-BfcSjidc.js";import{S as Y,L as F}from"./Search-C3kSmCYj.js";import{S as u}from"./Stack-7Os3jLN9.js";import{C as N}from"./Card-BUoHr3-c.js";import{A as J}from"./Avatar-Bw_uq7t-.js";import{E as C,C as Q,a as V,I as X,H as G}from"./Inventory2-1KYHFmZr.js";import{S as K}from"./ShoppingCart-DxLtTv84.js";import{C as Z}from"./CheckCircle-B77f2MdC.js";import"./useThemeProps-eSb-t_pk.js";const x=$`
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
`;function xe(){const S=O(),h=E(r=>r.user),[v,w]=c.useState([]),[k,b]=c.useState(!0),[n,I]=c.useState("All"),[p,z]=c.useState(null),D=["All","Processing","Delivered","Cancelled"],f=async()=>{if(!h){b(!1);return}try{const r=P(j,"orders"),t=R(r,q("timestamp","desc")),i=(await B(t)).docs.map(l=>({id:l.id,...l.data()}));w(i)}catch(r){console.error("Error fetching orders:",r)}finally{b(!1)}};c.useEffect(()=>{f()},[h]);const y=v.filter(r=>n==="All"?!0:(r.status==="pending"?"Processing":r.status).toLowerCase()===n.toLowerCase()),T=r=>{switch(r.toLowerCase()){case"pending":case"processing":return{label:"Processing",icon:e.jsx(G,{fontSize:"small"}),color:"warning.main",bgcolor:"rgba(237, 108, 2, 0.1)",borderColor:"rgba(237, 108, 2, 0.2)"};case"shipped":return{label:"Shipped",icon:e.jsx(F,{fontSize:"small"}),color:"info.main",bgcolor:"rgba(2, 136, 209, 0.1)",borderColor:"rgba(2, 136, 209, 0.2)"};case"delivered":return{label:"Delivered",icon:e.jsx(X,{fontSize:"small"}),color:"success.main",bgcolor:"rgba(46, 125, 50, 0.1)",borderColor:"rgba(46, 125, 50, 0.2)"};case"cancelled":return{label:"Cancelled",icon:e.jsx(V,{fontSize:"small"}),color:"error.main",bgcolor:"rgba(211, 47, 47, 0.1)",borderColor:"rgba(211, 47, 47, 0.2)"};default:return{label:"Completed",icon:e.jsx(Z,{fontSize:"small"}),color:"text.secondary",bgcolor:"action.hover",borderColor:"divider"}}},m=(r,t)=>{try{const s=H(j,"orders",r);M(s,{status:t}),f()}catch(s){console.error("Error updating order status:",s),alert("Failed to update order status = "+r)}},A=r=>{if(!r)return"Just now";const t=r.toDate(),i=new Date().getTime()-t.getTime(),l=Math.floor(i/(1e3*60*60*24));return l===0?`Today, ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:l===1?`Yesterday, ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},L=r=>{z(p===r?null:r)};return e.jsxs(o,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsx(o,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default",borderBottom:1,borderColor:"divider"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,height:60},children:[e.jsx(g,{sx:{ml:-1},onClick:()=>S({to:"/shop"}),children:e.jsx(U,{})}),e.jsx(a,{variant:"h6",sx:{fontWeight:"bold"},children:"Order History"}),e.jsx(g,{sx:{mr:-1},children:e.jsx(Y,{})})]})}),e.jsxs(o,{sx:{p:2},children:[e.jsx(o,{sx:{display:"flex",gap:1.5,overflowX:"auto",p:2,mb:2,"&::-webkit-scrollbar":{display:"none"},animation:`${x} 0.6s ease-out forwards`},children:D.map(r=>e.jsx(d,{variant:n===r?"contained":"outlined",onClick:()=>I(r),sx:{flexShrink:0,borderRadius:50,textTransform:"none",fontWeight:"bold",fontSize:"0.875rem",px:3,py:1,bgcolor:n===r?"primary.main":"background.paper",color:n===r?"black":"text.secondary",borderColor:n===r?"primary.main":"divider",boxShadow:n===r?"0 4px 12px rgba(242, 215, 13, 0.2)":"none","&:hover":{bgcolor:n===r?"primary.main":"action.hover",borderColor:n===r?"primary.main":"divider"}},children:r},r))}),k?e.jsx(o,{sx:{display:"flex",justifyContent:"center",py:8},children:e.jsx(W,{})}):y.length===0?e.jsx(o,{sx:{textAlign:"center",py:8,animation:`${x} 0.6s ease-out forwards`},children:e.jsx(a,{color:"text.secondary",children:"No orders found."})}):e.jsx(u,{spacing:2,sx:{animation:`${x} 0.6s ease-out forwards`,animationDelay:"0.1s"},children:y.map(r=>{const t=T(r.status);return e.jsx(N,{sx:{p:2,borderRadius:3,border:1,borderColor:"divider",boxShadow:"none",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",transition:"all 0.2s","&:active":{transform:"scale(0.98)"}},onClick:()=>L(r.id),children:e.jsxs(o,{sx:{width:"100%"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(J,{sx:{width:48,height:48,bgcolor:t.bgcolor,color:t.color,border:1,borderColor:t.borderColor},children:t.icon}),e.jsxs(o,{children:[e.jsxs(a,{variant:"body2",sx:{fontWeight:"bold"},children:["Order #",r.id.slice(0,5).toUpperCase()]}),e.jsx(a,{variant:"caption",sx:{color:"text.secondary",mt:.5,display:"block"},children:A(r.timestamp)})]})]}),e.jsxs(o,{sx:{textAlign:"right",display:"flex",alignItems:"center",gap:1},children:[e.jsxs(o,{children:[e.jsxs(a,{variant:"body2",sx:{fontWeight:"bold"},children:["₹",r.total.toLocaleString()]}),e.jsx(o,{sx:{display:"inline-block",mt:.5,px:1.5,py:.25,borderRadius:10,bgcolor:t.bgcolor,color:t.color,fontSize:"0.625rem",fontWeight:"bold",textTransform:"uppercase",letterSpacing:.5},children:t.label})]}),e.jsx(g,{size:"small",sx:{transform:p===r.id?"rotate(180deg)":"none",transition:"transform 0.3s"},children:e.jsx(C,{})})]})]}),e.jsx(Q,{in:p===r.id,timeout:"auto",unmountOnExit:!0,children:e.jsxs(o,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsx(a,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:"Order Items"}),e.jsx(u,{spacing:1.5,children:r.items?.map((s,i)=>e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(o,{sx:{width:32,height:32,bgcolor:"action.hover",borderRadius:1.5,display:"flex",alignItems:"center",justifyContent:"center",color:"text.secondary"},children:e.jsx(K,{sx:{fontSize:"1.25rem"}})}),e.jsxs(o,{sx:{flex:1},children:[e.jsx(a,{variant:"body2",sx:{fontWeight:"bold"},children:s.name}),e.jsxs(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:[s.selectedSize?.label||"Single Variant"," ",e.jsx("br",{}),"Quantity : ",s.quantity]})]}),e.jsxs(a,{variant:"body2",sx:{fontWeight:600},children:["₹",(s.buyPrice*s.quantity).toLocaleString()]}),e.jsx("hr",{})]},i))}),e.jsxs(u,{direction:"row",spacing:1,sx:{mt:2},children:[e.jsx(d,{size:"small",variant:"outlined",color:"success",onClick:()=>m(r.id,"Delivered"),children:"Delivered"}),e.jsx(d,{size:"small",variant:"outlined",color:"error",onClick:()=>m(r.id,"Cancelled"),children:"Cancelled"}),e.jsx(d,{size:"small",variant:"outlined",color:"error",onClick:()=>m(r.id,"Processing"),children:"Processing"})]})]})})]})},r.id)})}),e.jsx(o,{sx:{mt:4,textAlign:"center",animation:`${x} 0.6s ease-out forwards`,animationDelay:"0.3s"},children:e.jsx(d,{size:"small",endIcon:e.jsx(C,{}),sx:{color:"primary.main",fontWeight:"bold",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:1,"&:hover":{bgcolor:"transparent",color:"primary.dark"}},children:"Load More"})})]})]})}export{xe as component};

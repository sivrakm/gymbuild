import{j as e,r as x,C as X,S as q,U as J,V as K,W as Q}from"./index-jdAVBQR5.js";import{u,A as Y,T as Z,a as ee}from"./productStore-CZw0d3nx.js";import{n as f,C as k,a as re,I as te,P as se,S as R,N as ie,E as oe,b as ae}from"./index.browser-NNPkR3kA.js";import{c as w,a as s,T as i,b,P as v}from"./Button-CDktgM43.js";import{I as g}from"./IconButton-DiSUjgUS.js";import{T as c,I as p}from"./TextField-Dx7K1fj0.js";import{S as n}from"./Stack-8yuTth8L.js";import{M as y,S as ne}from"./ShoppingBag-Ba301NNz.js";import{G as C}from"./Grid-CgIdhSVq.js";import{D as A}from"./Delete-BF9dx5Ai.js";import{F as le}from"./FitnessCenter-D6zbyvN4.js";import"./useThemeProps-BMmSTa5s.js";import"./SwitchBase-BjqKUy7H.js";import"./Select-DoC7yy9n.js";import"./isMuiElement-DQ9WcsgZ.js";const ce=w(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),de=w([e.jsx("path",{d:"m12 12.9-2.13 2.09c-.56.56-.87 1.29-.87 2.07C9 18.68 10.35 20 12 20s3-1.32 3-2.94c0-.78-.31-1.52-.87-2.07z"},"0"),e.jsx("path",{d:"m16 6-.44.55C14.38 8.02 12 7.19 12 5.3V2S4 6 4 13c0 2.92 1.56 5.47 3.89 6.86-.56-.79-.89-1.76-.89-2.8 0-1.32.52-2.56 1.47-3.5L12 10.1l3.53 3.47c.95.93 1.47 2.17 1.47 3.5 0 1.02-.31 1.96-.85 2.75 1.89-1.15 3.29-3.06 3.71-5.3.66-3.55-1.07-6.9-3.86-8.52"},"1")]),he=w(e.jsx("path",{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4zm-6 4h-4v-4h4z"})),D=[{value:"tag",label:"Tag",icon:e.jsx(he,{})},{value:"fitness_center",label:"Dumbbell",icon:e.jsx(le,{})},{value:"local_fire_department",label:"Fire",icon:e.jsx(de,{})},{value:"shopping_bag",label:"Bag",icon:e.jsx(ne,{})}],ue=[{value:"black",color:"#000000"},{value:"white",color:"#ffffff"},{value:"red",color:"#ef4444"},{value:"blue",color:"#3b82f6"},{value:"yellow",color:"#f2b90d"}];function ze(){const N=u(r=>r.pushProducttoDb),F=u(r=>r.updateProduct),T=u(r=>r.products),B=u(r=>r.fetchProducts),E=u(r=>r.deleteProduct),U=u(r=>r.categories);x.useState(()=>{B()});const[m,I]=x.useState(null),[O,P]=x.useState(!1),S=x.useRef(null),_=async r=>{const o=r.target.files?.[0];if(o){P(!0);try{const a=q(J,`products/${f()}_${o.name}`),h=await K(a,o),j=await Q(h.ref);d(G=>({...G,src:j}))}catch(a){console.error("Error uploading image: ",a),alert("Failed to upload image.")}finally{P(!1)}}},[t,d]=x.useState({name:"",id:f(),category:"",detail:"",price:void 0,originalPrice:void 0,icon:"fitness_center",imageColor:"black",src:"",sale:!1,isNew:!0,sizes:[],categoryOnly:!1}),l=(r,o)=>{d(a=>({...a,[r]:o}))},W=(r,o,a)=>{const h=[...t.sizes||[]];h[r]={...h[r],[o]:a},d(j=>({...j,sizes:h}))},L=()=>{d(r=>({...r,sizes:[...r.sizes||[],{label:"",price:0}]}))},V=r=>{d(o=>({...o,sizes:o.sizes?.filter((a,h)=>h!==r)}))},$=r=>{d({...r}),I(r.id),window.scrollTo({top:0,behavior:"smooth"})},H=async r=>{confirm("Are you sure you want to delete this product?")&&await E(r)},z=()=>{d({name:"",id:f(),category:"",detail:"",price:void 0,originalPrice:void 0,icon:"fitness_center",imageColor:"black",src:"",sale:!1,isNew:!0,sizes:[],categoryOnly:!1}),I(null)},M=async()=>{try{if(console.log("Saving product...",t),!t.name||!t.price){alert("Please fill in at least Name and Price");return}m?(await F(t),alert("Product updated successfully!")):(await N(t),alert("Product saved successfully!")),z()}catch(r){console.error("Error saving product:",r),alert("Failed to save product")}};return e.jsxs(s,{sx:{minHeight:"100vh",bgcolor:"background.default",pb:10},children:[e.jsx(Y,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(Z,{children:[e.jsx(g,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(ee,{})}),e.jsx(i,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:m?"Edit Product":"Add Product"}),m&&e.jsx(b,{color:"inherit",onClick:z,children:"Cancel Edit"})]})}),e.jsxs(k,{maxWidth:"sm",sx:{py:3,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:"bold",textTransform:"uppercase"},children:"Product Image"}),e.jsx(c,{fullWidth:!0,placeholder:"Paste image URL here...",value:t.src,onChange:r=>l("src",r.target.value),InputProps:{endAdornment:e.jsxs(p,{position:"end",children:[e.jsx(g,{onClick:()=>S.current?.click(),edge:"end",children:O?e.jsx(X,{size:24}):e.jsx(re,{color:"primary"})}),e.jsx("input",{type:"file",hidden:!0,ref:S,accept:"image/*",onChange:_})]}),sx:{borderRadius:3}}}),e.jsx(s,{sx:{mt:2,height:160,borderRadius:3,border:"2px dashed",borderColor:"divider",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",bgcolor:"action.hover"},children:t.src?e.jsx(s,{component:"img",src:t.src,sx:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsxs(e.Fragment,{children:[e.jsx(te,{sx:{fontSize:40,opacity:.5,mb:1}}),e.jsx(i,{variant:"caption",sx:{opacity:.7},children:"Image preview will appear here"})]})})]}),e.jsxs(n,{spacing:2,children:[e.jsx(n,{direction:"row",spacing:2,children:e.jsxs(s,{flex:1,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Product Name"}),e.jsx(c,{fullWidth:!0,placeholder:"e.g. Protein Whey",value:t.name,onChange:r=>l("name",r.target.value)})]})}),e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Category"}),e.jsxs(c,{select:!0,fullWidth:!0,value:t.category,onChange:r=>l("category",r.target.value),children:[e.jsx(y,{value:"",disabled:!0,children:"Select Category"}),U.filter(r=>r!=="All Items").map(r=>e.jsx(y,{value:r,children:r},r))]})]}),e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Detail"}),e.jsx(c,{fullWidth:!0,multiline:!0,minRows:3,placeholder:"Describe the product features...",value:t.detail,onChange:r=>l("detail",r.target.value)})]})]}),e.jsx(s,{sx:{my:1,borderTop:1,borderColor:"divider",borderStyle:"dashed"}}),e.jsxs(C,{container:!0,spacing:2,children:[e.jsxs(C,{size:6,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Price"}),e.jsx(c,{fullWidth:!0,type:"number",placeholder:"0.00",value:t.price,onChange:r=>l("price",Number(r.target.value)),InputProps:{startAdornment:e.jsx(p,{position:"start",children:"$"})}})]}),e.jsxs(C,{size:6,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Original Price"}),e.jsx(c,{fullWidth:!0,type:"number",placeholder:"0.00",value:t.originalPrice||"",onChange:r=>l("originalPrice",Number(r.target.value)),InputProps:{startAdornment:e.jsx(p,{position:"start",children:"$"})}})]})]}),e.jsxs(n,{spacing:2,children:[e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Icon"}),e.jsx(c,{select:!0,fullWidth:!0,value:t.icon,onChange:r=>l("icon",r.target.value),InputProps:{startAdornment:e.jsx(p,{position:"start",children:D.find(r=>r.value===t.icon)?.icon})},children:D.map(r=>e.jsx(y,{value:r.value,children:e.jsxs(n,{direction:"row",alignItems:"center",spacing:1,children:[r.icon,e.jsx("span",{children:r.label})]})},r.value))})]}),e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Image Color"}),e.jsx(n,{direction:"row",spacing:1.5,sx:{overflowX:"auto",py:1},children:ue.map(r=>e.jsx(s,{onClick:()=>l("imageColor",r.value),sx:{width:40,height:40,borderRadius:"50%",bgcolor:r.color,border:r.value==="white"?"1px solid #e5e7eb":"none",cursor:"pointer",ring:t.imageColor===r.value?2:0,ringColor:"primary.main",ringOffset:2,boxShadow:1,transition:"all 0.2s",transform:t.imageColor===r.value?"scale(1.1)":"scale(1)"}},r.value))})]})]}),e.jsxs(v,{variant:"outlined",sx:{borderRadius:3,overflow:"hidden"},children:[e.jsxs(s,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px dashed",borderColor:"divider"},children:[e.jsxs(n,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(s,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(se,{fontSize:"small"})}),e.jsx(i,{fontWeight:500,children:"On Sale"})]}),e.jsx(R,{checked:t.sale,onChange:r=>l("sale",r.target.checked)})]}),e.jsxs(s,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(n,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(s,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ie,{fontSize:"small"})}),e.jsx(i,{fontWeight:500,children:"New Arrival"})]}),e.jsx(R,{checked:t.isNew,onChange:r=>l("isNew",r.target.checked)})]})]}),e.jsxs(s,{children:[e.jsx(i,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Available Sizes"}),e.jsxs(n,{spacing:2,children:[t.sizes?.map((r,o)=>e.jsxs(n,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(c,{sx:{width:80},placeholder:"Label",value:r.label,onChange:a=>W(o,"label",a.target.value),inputProps:{style:{textAlign:"center"}}}),e.jsx(c,{fullWidth:!0,placeholder:"0.00",type:"number",value:r.price,onChange:a=>W(o,"price",Number(a.target.value)),InputProps:{startAdornment:e.jsx(p,{position:"start",children:"$"})}}),e.jsx(g,{color:"error",onClick:()=>V(o),sx:{bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"},borderRadius:2},children:e.jsx(A,{})})]},o)),e.jsx(b,{variant:"outlined",startIcon:e.jsx(ce,{}),onClick:L,sx:{py:1.5,borderStyle:"dashed",borderWidth:2,borderRadius:3,"&:hover":{borderWidth:2}},children:"Add Size Variant"})]})]}),e.jsxs(s,{sx:{mt:4},children:[e.jsx(i,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Manage Products"}),e.jsx(n,{spacing:2,children:T.map(r=>e.jsx(v,{variant:"outlined",sx:{p:2,borderRadius:2},children:e.jsxs(n,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(s,{component:"img",src:r.src||"",sx:{width:60,height:60,objectFit:"cover",borderRadius:2,bgcolor:"action.hover"}}),e.jsxs(s,{flex:1,children:[e.jsx(i,{fontWeight:600,noWrap:!0,children:r.name}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["$",r.price]}),e.jsx(i,{variant:"caption",color:"text.secondary",children:r.category})]}),e.jsx(g,{size:"small",onClick:()=>$(r),children:e.jsx(oe,{})}),e.jsx(g,{size:"small",color:"error",onClick:()=>H(r.id),children:e.jsx(A,{})})]})},r.id))})]})]}),e.jsx(v,{sx:{position:"fixed",bottom:0,left:0,right:0,p:2,bgcolor:"background.paper",borderTop:1,borderColor:"divider",zIndex:10},elevation:4,children:e.jsx(k,{maxWidth:"sm",children:e.jsx(b,{fullWidth:!0,variant:"contained",size:"large",startIcon:e.jsx(ae,{}),onClick:M,sx:{height:56,borderRadius:3,fontSize:"1.1rem",fontWeight:"bold",boxShadow:2},children:m?"Update Product":"Save Product"})})})]})}export{ze as component};
